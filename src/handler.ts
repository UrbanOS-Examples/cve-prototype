
import { RawData } from 'ws';
import { parseMessage } from './cveParser';

function emptyMessage(data: Buffer | ArrayBuffer | Buffer[]) {
    return (
        data === undefined ||
        data === null ||
        data.toString().trim().length === 0
    );
}

export function handleMessage(data: RawData): void {
    if (emptyMessage(data)) {
        console.log('Received empty message');
        return;
    }
    const streamData = data.toString();
    if (streamData.includes('phx_reply')) {
        console.log(streamData);
        return;
    }
    parseMessage(streamData)
}